<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Permutation test for the derived scores of each sample — generateNull • singscore</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Permutation test for the derived scores of each sample — generateNull"><meta property="og:description" content="This function generates a number of random gene sets that
have the same number of genes as the scored gene set. It scores each random
gene set and returns a matrix of scores for all samples.
The empirical scores are used to calculate the empirical p-values and plot
the null distribution. The implementation uses BiocParallel::bplapply()
for easy access to parallel backends. Note that one should pass the same
values to the upSet, downSet, centerScore and bidirectional
arguments as what they provide for the simpleScore() function to generate
a proper null distribution."><meta property="og:image" content="https://DavisLaboratory.github.io/singscore/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">singscore</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.29.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/singscore.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DavisLaboratory/singscore" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Permutation test for the derived scores of each sample</h1>
    <small class="dont-index">Source: <a href="https://github.com/DavisLaboratory/singscore/blob/master/R/generatNullGeneric.R" class="external-link"><code>R/generatNullGeneric.R</code></a></small>
    <div class="hidden name"><code>generateNull.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function generates a number of random gene sets that
have the same number of genes as the scored gene set. It scores each random
gene set and returns a matrix of scores for all samples.
The empirical scores are used to calculate the empirical p-values and plot
the null distribution. The implementation uses <code><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">BiocParallel::bplapply()</a></code>
for easy access to parallel backends. Note that one should pass the same
values to the <code>upSet</code>, <code>downSet</code>, <code>centerScore</code> and <code>bidirectional</code>
arguments as what they provide for the <code><a href="simpleScore.html">simpleScore()</a></code> function to generate
a proper null distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generateNull</span><span class="op">(</span></span>
<span>  <span class="va">upSet</span>,</span>
<span>  downSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">rankData</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">1e+06</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  useBPPARAM <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'vector,ANY'</span></span>
<span><span class="fu">generateNull</span><span class="op">(</span></span>
<span>  <span class="va">upSet</span>,</span>
<span>  downSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">rankData</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">1e+06</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  useBPPARAM <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GeneSet,ANY'</span></span>
<span><span class="fu">generateNull</span><span class="op">(</span></span>
<span>  <span class="va">upSet</span>,</span>
<span>  downSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">rankData</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">1e+06</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  useBPPARAM <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'vector,vector'</span></span>
<span><span class="fu">generateNull</span><span class="op">(</span></span>
<span>  <span class="va">upSet</span>,</span>
<span>  downSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">rankData</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">1e+06</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  useBPPARAM <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GeneSet,GeneSet'</span></span>
<span><span class="fu">generateNull</span><span class="op">(</span></span>
<span>  <span class="va">upSet</span>,</span>
<span>  downSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">rankData</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">1e+06</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  useBPPARAM <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-upset">upSet<a class="anchor" aria-label="anchor" href="#arg-upset"></a></dt>
<dd><p>A GeneSet object or character vector of gene IDs of up-regulated
gene set or a gene set where the nature of genes is not known</p></dd>


<dt id="arg-downset">downSet<a class="anchor" aria-label="anchor" href="#arg-downset"></a></dt>
<dd><p>A GeneSet object or character vector of gene IDs of
down-regulated gene set or NULL where only a single gene set is provided</p></dd>


<dt id="arg-rankdata">rankData<a class="anchor" aria-label="anchor" href="#arg-rankdata"></a></dt>
<dd><p>A matrix object, ranked gene expression matrix data generated
using the <code><a href="rankGenes.html">rankGenes()</a></code> function (make sure this matrix is not modified, see
details)</p></dd>


<dt id="arg-subsamples">subSamples<a class="anchor" aria-label="anchor" href="#arg-subsamples"></a></dt>
<dd><p>A vector of sample labels/indices that will be used to
subset the rankData matrix. All samples will be scored if not provided</p></dd>


<dt id="arg-centerscore">centerScore<a class="anchor" aria-label="anchor" href="#arg-centerscore"></a></dt>
<dd><p>A Boolean, specifying whether scores should be centered
around 0, default as TRUE. Note: scores never centered if <code>knownDirection = FALSE</code></p></dd>


<dt id="arg-knowndirection">knownDirection<a class="anchor" aria-label="anchor" href="#arg-knowndirection"></a></dt>
<dd><p>A boolean, determining whether the gene set should be
considered to be directional or not. A gene set is directional if the type
of genes in it are known i.e. up- or down-regulated. This should be set to
TRUE if the gene set is composed of both up- AND down-regulated genes.
Defaults to TRUE. This parameter becomes irrelevant when both upSet(Colc)
and downSet(Colc) are provided.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>integer, the number of permutation repeats or the number of random
gene sets to be generated, default as 1000</p></dd>


<dt id="arg-ncores-">ncores, <a class="anchor" aria-label="anchor" href="#arg-ncores-"></a></dt>
<dd><p>integer, the number of CPU cores the function can use</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>integer, set the seed for randomisation</p></dd>


<dt id="arg-usebpparam-">useBPPARAM, <a class="anchor" aria-label="anchor" href="#arg-usebpparam-"></a></dt>
<dd><p>the backend the function uses, if NULL is provided, the
function uses the default parallel backend which is the first on the list
returned by <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">BiocParallel::registered()</a></code> i.e
<code>BiocParallel::registered()[[1]]</code> for your machine. It can be changed
explicitly by passing a BPPARAM</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A matrix of empirical scores for all samples</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="http://lcolladotor.github.io/2016/03/07/BiocParallel/#.WgXMF61L28U" class="external-link">Post about BiocParallel</a>
<code>browseVignettes("BiocParallel")</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Ruqian Lyu</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">ranked</span> <span class="op">&lt;-</span> <span class="fu"><a href="rankGenes.html">rankGenes</a></span><span class="op">(</span><span class="va">toy_expr_se</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scoredf</span> <span class="op">&lt;-</span> <span class="fu"><a href="simpleScore.html">simpleScore</a></span><span class="op">(</span><span class="va">ranked</span>, upSet <span class="op">=</span> <span class="va">toy_gs_up</span>, downSet <span class="op">=</span> <span class="va">toy_gs_dn</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># find out what backends can be registered on your machine</span></span></span>
<span class="r-in"><span><span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">registered</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $MulticoreParam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: MulticoreParam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpisup: FALSE; bpnworkers: 4; bptasks: 0; bpjobname: BPJOB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bplog: FALSE; bpthreshold: INFO; bpstopOnError: TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpRNGseed: ; bptimeout: NA; bpprogressbar: FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpexportglobals: TRUE; bpexportvariables: FALSE; bpforceGC: FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpfallback: TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bplogdir: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpresultdir: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cluster type: FORK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $SnowParam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SnowParam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpisup: FALSE; bpnworkers: 4; bptasks: 0; bpjobname: BPJOB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bplog: FALSE; bpthreshold: INFO; bpstopOnError: TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpRNGseed: ; bptimeout: NA; bpprogressbar: FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpexportglobals: TRUE; bpexportvariables: TRUE; bpforceGC: FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpfallback: TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bplogdir: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpresultdir: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cluster type: SOCK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $SerialParam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SerialParam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpisup: FALSE; bpnworkers: 1; bptasks: 0; bpjobname: BPJOB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bplog: FALSE; bpthreshold: INFO; bpstopOnError: TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpRNGseed: ; bptimeout: NA; bpprogressbar: FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpexportglobals: FALSE; bpexportvariables: FALSE; bpforceGC: FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpfallback: FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bplogdir: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bpresultdir: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># the first one is the default backend</span></span></span>
<span class="r-in"><span><span class="co"># ncores = ncores &lt;- parallel::detectCores() - 2</span></span></span>
<span class="r-in"><span><span class="va">permuteResult</span> <span class="op">=</span> <span class="fu">generateNull</span><span class="op">(</span>upSet <span class="op">=</span> <span class="va">toy_gs_up</span>, downSet <span class="op">=</span> <span class="va">toy_gs_dn</span>, <span class="va">ranked</span>,</span></span>
<span class="r-in"><span>centerScore <span class="op">=</span> <span class="cn">TRUE</span>, B <span class="op">=</span><span class="fl">10</span>, seed <span class="op">=</span> <span class="fl">1</span>, ncores <span class="op">=</span> <span class="fl">1</span> <span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dharmesh D. Bhuva, Ruqian Lyu, Momeneh Foroutan, Malvika Kharbanda.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

      </footer></div>






  </body></html>

