<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>single-sample gene-set scoring method for multiple signatures — multiScore • singscore</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="single-sample gene-set scoring method for multiple signatures — multiScore"><meta property="og:description" content="This function computes 'singscores' using a ranked gene
expression matrix obtained from the rankGenes() function and a
GeneSetCollection object or a list of GeneSet objects. It returns a list of
two matrices containing the scores and dispersions. This function should be
used when scoring needs to be performed for multiple signatures. It is
faster than applying simpleScore() across the different signatures
independently."><meta property="og:image" content="https://DavisLaboratory.github.io/singscore/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">singscore</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.19.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/singscore.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DavisLaboratory/singscore" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>single-sample gene-set scoring method for multiple signatures</h1>
    <small class="dont-index">Source: <a href="https://github.com/DavisLaboratory/singscore/blob/HEAD/R/multiScoreGeneric.R" class="external-link"><code>R/multiScoreGeneric.R</code></a></small>
    <div class="hidden name"><code>multiScore.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes 'singscores' using a ranked gene
expression matrix obtained from the <code><a href="rankGenes.html">rankGenes()</a></code> function and a
GeneSetCollection object or a list of GeneSet objects. It returns a list of
two matrices containing the scores and dispersions. This function should be
used when scoring needs to be performed for multiple signatures. It is
faster than applying <code><a href="simpleScore.html">simpleScore()</a></code> across the different signatures
independently.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">multiScore</span><span class="op">(</span></span>
<span>  <span class="va">rankData</span>,</span>
<span>  <span class="va">upSetColc</span>,</span>
<span>  <span class="va">downSetColc</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dispersionFun <span class="op">=</span> <span class="va">mad</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for matrix,GeneSetCollection,missing</span></span>
<span><span class="fu">multiScore</span><span class="op">(</span></span>
<span>  <span class="va">rankData</span>,</span>
<span>  <span class="va">upSetColc</span>,</span>
<span>  <span class="va">downSetColc</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dispersionFun <span class="op">=</span> <span class="va">mad</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for matrix,GeneSetCollection,GeneSetCollection</span></span>
<span><span class="fu">multiScore</span><span class="op">(</span></span>
<span>  <span class="va">rankData</span>,</span>
<span>  <span class="va">upSetColc</span>,</span>
<span>  <span class="va">downSetColc</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dispersionFun <span class="op">=</span> <span class="va">mad</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for matrix,list,missing</span></span>
<span><span class="fu">multiScore</span><span class="op">(</span></span>
<span>  <span class="va">rankData</span>,</span>
<span>  <span class="va">upSetColc</span>,</span>
<span>  <span class="va">downSetColc</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dispersionFun <span class="op">=</span> <span class="va">mad</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for matrix,list,list</span></span>
<span><span class="fu">multiScore</span><span class="op">(</span></span>
<span>  <span class="va">rankData</span>,</span>
<span>  <span class="va">upSetColc</span>,</span>
<span>  <span class="va">downSetColc</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dispersionFun <span class="op">=</span> <span class="va">mad</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>rankData</dt>
<dd><p>A matrix object, ranked gene expression matrix data generated
using the <code><a href="rankGenes.html">rankGenes()</a></code> function (make sure this matrix is not modified, see
details)</p></dd>


<dt>upSetColc</dt>
<dd><p>A GeneSetCollection object, a list of GeneSet objects, or a
list of character vectors of up-regulated (or mixed, see
<code><a href="simpleScore.html">simpleScore</a></code>) gene sets.</p></dd>


<dt>downSetColc</dt>
<dd><p>A GeneSetCollection object, a list of GeneSet objects, or a
list of character vectors of down-regulated gene sets. NULL otherwise. Names
of gene sets within this collection/list should be the same as those of the
upSetColc</p></dd>


<dt>subSamples</dt>
<dd><p>A vector of sample labels/indices that will be used to
subset the rankData matrix. All samples will be scored if not provided</p></dd>


<dt>centerScore</dt>
<dd><p>A Boolean, specifying whether scores should be centered
around 0, default as TRUE. Note: scores never centered if <code>knownDirection = FALSE</code></p></dd>


<dt>dispersionFun</dt>
<dd><p>A function, dispersion function with default being <code>mad</code></p></dd>


<dt>knownDirection</dt>
<dd><p>A boolean, determining whether the gene set should be
considered to be directional or not. A gene set is directional if the type
of genes in it are known i.e. up- or down-regulated. This should be set to
TRUE if the gene set is composed of both up- AND down-regulated genes.
Defaults to TRUE. This parameter becomes irrelevant when both upSet(Colc)
and downSet(Colc) are provided.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list of two matrices containing the scores and dispersions</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></code> <code>"GeneSet"</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">ranked</span> <span class="op">&lt;-</span> <span class="fu"><a href="rankGenes.html">rankGenes</a></span><span class="op">(</span><span class="va">toy_expr_se</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">GSEABase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-class.html" class="external-link">setName</a></span><span class="op">(</span><span class="va">toy_gs_up</span><span class="op">)</span>  <span class="op">=</span> <span class="st">"toy_gs_up"</span></span></span>
<span class="r-in"><span><span class="fu">GSEABase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-class.html" class="external-link">setName</a></span><span class="op">(</span><span class="va">toy_gs_dn</span><span class="op">)</span>  <span class="op">=</span> <span class="st">"toy_gs_dn"</span></span></span>
<span class="r-in"><span><span class="va">gslist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">toy_gs_up</span>, <span class="va">toy_gs_dn</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gscolc</span> <span class="op">&lt;-</span> <span class="fu">GSEABase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSetCollection-methods.html" class="external-link">GeneSetCollection</a></span><span class="op">(</span><span class="va">gslist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scoredf</span> <span class="op">&lt;-</span> <span class="fu">multiScore</span><span class="op">(</span><span class="va">ranked</span>, upSetColc <span class="op">=</span> <span class="va">gscolc</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dharmesh D. Bhuva, Ruqian Lyu, Momeneh Foroutan, Malvika Kharbanda.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

