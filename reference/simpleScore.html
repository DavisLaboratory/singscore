<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>single-sample gene-set scoring method — simpleScore • singscore</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="single-sample gene-set scoring method — simpleScore"><meta property="og:description" content="This function computes 'singscores' using an unmodified
ranked gene expression matrix obtained from the rankGenes() function and a
gene set or a pair of up-regulated and down-regulated gene sets. It returns
a data.frame of scores and dispersions for each sample. The gene sets can be
in vector format or as GeneSet objects (from GSEABase packages). If samples
need to be scored against a single gene set, the upSet argument
should be used to pass the gene set while the downSet argument is set
to NULL. This setting is ideal for gene sets representing gene
ontologies where the nature of the genes is unknown (up- or down-regulated)."><meta property="og:image" content="https://DavisLaboratory.github.io/singscore/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">singscore</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.29.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/singscore.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DavisLaboratory/singscore" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>single-sample gene-set scoring method</h1>
    <small class="dont-index">Source: <a href="https://github.com/DavisLaboratory/singscore/blob/master/R/simpleScoreGeneric.R" class="external-link"><code>R/simpleScoreGeneric.R</code></a></small>
    <div class="hidden name"><code>simpleScore.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes 'singscores' using an <strong>unmodified</strong>
ranked gene expression matrix obtained from the <code><a href="rankGenes.html">rankGenes()</a></code> function and a
gene set or a pair of up-regulated and down-regulated gene sets. It returns
a data.frame of scores and dispersions for each sample. The gene sets can be
in vector format or as GeneSet objects (from GSEABase packages). If samples
need to be scored against a single gene set, the <code>upSet</code> argument
should be used to pass the gene set while the <code>downSet</code> argument is set
to <code>NULL</code>. This setting is ideal for gene sets representing gene
ontologies where the nature of the genes is unknown (up- or down-regulated).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simpleScore</span><span class="op">(</span></span>
<span>  <span class="va">rankData</span>,</span>
<span>  <span class="va">upSet</span>,</span>
<span>  downSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dispersionFun <span class="op">=</span> <span class="va">mad</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'matrix,vector,missing'</span></span>
<span><span class="fu">simpleScore</span><span class="op">(</span></span>
<span>  <span class="va">rankData</span>,</span>
<span>  <span class="va">upSet</span>,</span>
<span>  downSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dispersionFun <span class="op">=</span> <span class="va">mad</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'matrix,GeneSet,missing'</span></span>
<span><span class="fu">simpleScore</span><span class="op">(</span></span>
<span>  <span class="va">rankData</span>,</span>
<span>  <span class="va">upSet</span>,</span>
<span>  downSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dispersionFun <span class="op">=</span> <span class="va">mad</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'matrix,vector,vector'</span></span>
<span><span class="fu">simpleScore</span><span class="op">(</span></span>
<span>  <span class="va">rankData</span>,</span>
<span>  <span class="va">upSet</span>,</span>
<span>  downSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dispersionFun <span class="op">=</span> <span class="va">mad</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'matrix,GeneSet,GeneSet'</span></span>
<span><span class="fu">simpleScore</span><span class="op">(</span></span>
<span>  <span class="va">rankData</span>,</span>
<span>  <span class="va">upSet</span>,</span>
<span>  downSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dispersionFun <span class="op">=</span> <span class="va">mad</span>,</span>
<span>  knownDirection <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-rankdata">rankData<a class="anchor" aria-label="anchor" href="#arg-rankdata"></a></dt>
<dd><p>A matrix object, ranked gene expression matrix data generated
using the <code><a href="rankGenes.html">rankGenes()</a></code> function (make sure this matrix is not modified, see
details)</p></dd>


<dt id="arg-upset">upSet<a class="anchor" aria-label="anchor" href="#arg-upset"></a></dt>
<dd><p>A GeneSet object or character vector of gene IDs of up-regulated
gene set or a gene set where the nature of genes is not known</p></dd>


<dt id="arg-downset">downSet<a class="anchor" aria-label="anchor" href="#arg-downset"></a></dt>
<dd><p>A GeneSet object or character vector of gene IDs of
down-regulated gene set or NULL where only a single gene set is provided</p></dd>


<dt id="arg-subsamples">subSamples<a class="anchor" aria-label="anchor" href="#arg-subsamples"></a></dt>
<dd><p>A vector of sample labels/indices that will be used to
subset the rankData matrix. All samples will be scored if not provided</p></dd>


<dt id="arg-centerscore">centerScore<a class="anchor" aria-label="anchor" href="#arg-centerscore"></a></dt>
<dd><p>A Boolean, specifying whether scores should be centered
around 0, default as TRUE. Note: scores never centered if <code>knownDirection = FALSE</code></p></dd>


<dt id="arg-dispersionfun">dispersionFun<a class="anchor" aria-label="anchor" href="#arg-dispersionfun"></a></dt>
<dd><p>A function, dispersion function with default being <code>mad</code></p></dd>


<dt id="arg-knowndirection">knownDirection<a class="anchor" aria-label="anchor" href="#arg-knowndirection"></a></dt>
<dd><p>A boolean, determining whether the gene set should be
considered to be directional or not. A gene set is directional if the type
of genes in it are known i.e. up- or down-regulated. This should be set to
TRUE if the gene set is composed of both up- AND down-regulated genes.
Defaults to TRUE. This parameter becomes irrelevant when both upSet(Colc)
and downSet(Colc) are provided.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data.frame consists of singscores and dispersions for all samples</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Signature scores can be computed using transcriptome-wide
measurements or using a smaller set of measuremnts. If ranks are computed
using the default invocation of <code>rankgenes</code>, the former method is applied
where the rank of each gene in the signature is computed relative to all
other genes in the dataset. Accuracy of this approximation of the relative
expression of a gene will be improved if all or most transctripts are
measured in the experiment. This was the approach proposed in the original
manucript of singscore (Foroutan M, Bhuva DD, et al 2018).</p>
<p>If instead a selected panel of genes is measured (such as from nanostring or
RT-qPCR), a different rank approximation methods using a small set of stable
genes can be used. This approach only requires measurements of genes in the
signature and a small set of stable genes. This approach of scoring can be
invoked by producing a rank matrix by passing in the <code>stableGenes</code> argument
of <code>rankGenes</code>. Stable genes in solid cancers and in blood can be retrieved
using <code>getStableGenes</code>. Upon providing a set of stable genes, <code>rankGenes</code>
automatically ranks all genes relative to these stable genes. When
<code>simpleScore</code> is provided with a rank matrix constructed using stable genes,
it automatically computes scores using a new approach. Details of the set of
stable genes, the new rank estimation approach and the new scoring approach
will soon be published (manuscript in preparation).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Foroutan, M., Bhuva, D. D., Lyu, R., Horan, K., Cursons, J., &amp;
Davis, M. J. (2018). Single sample scoring of molecular phenotypes. BMC
bioinformatics, 19(1), 1-10.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="rankGenes.html">rankGenes</a></code>, <code><a href="getStableGenes.html">getStableGenes</a></code>,
<code><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></code>, <code>"GeneSet"</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">ranked</span> <span class="op">&lt;-</span> <span class="fu"><a href="rankGenes.html">rankGenes</a></span><span class="op">(</span><span class="va">toy_expr_se</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scoredf</span> <span class="op">&lt;-</span> <span class="fu">simpleScore</span><span class="op">(</span><span class="va">ranked</span>, upSet <span class="op">=</span> <span class="va">toy_gs_up</span>, downSet <span class="op">=</span> <span class="va">toy_gs_dn</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># toy_gs_up is a GeneSet object, alternatively a vector of gene ids may also</span></span></span>
<span class="r-in"><span><span class="co"># be supplied.</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dharmesh D. Bhuva, Ruqian Lyu, Momeneh Foroutan, Malvika Kharbanda.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

      </footer></div>






  </body></html>

